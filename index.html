<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>$WALRUS Presale</title>
  <style>
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background:#070a12;
      color:#fff;
      text-align:center;
    }
    .hero{ padding:28px 16px 10px; }
    .logo{
      width:220px;
      border-radius:18px;
      box-shadow:0 0 28px rgba(0,255,200,.45);
    }
    h1{ margin:14px 0 6px; font-size:44px; letter-spacing:1px; }
    .sub{ opacity:.9; font-size:16px; margin-bottom:14px; }
    .card{
      max-width:560px;
      margin:14px auto;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius:16px;
      padding:18px;
      backdrop-filter: blur(8px);
      text-align:left;
    }
    .big{
      font-size:22px;
      margin:0;
      color:#00ffd5;
      font-weight:800;
      text-align:center;
    }
    .row{
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top:10px;
    }
    .pill{
      padding:10px 14px;
      border-radius:999px;
      background:rgba(0,255,213,.12);
      border:1px solid rgba(0,255,213,.25);
      font-weight:700;
      font-size:14px;
      text-align:center;
    }
    .btn{
      display:inline-block;
      margin-top:14px;
      padding:14px 22px;
      border-radius:14px;
      background:#00ffd5;
      color:#000;
      text-decoration:none;
      font-weight:900;
      font-size:16px;
    }
    .note{
      font-size:13px;
      opacity:.85;
      margin-top:10px;
      line-height:1.45;
      text-align:left;
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      word-break:break-all;
      padding:10px 12px;
      background:rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.10);
      border-radius:12px;
      margin-top:10px;
      font-size:13px;
    }
    input{
      width:100%;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.06);
      color:#fff;
      font-size:14px;
      box-sizing:border-box;
      margin-top:10px;
    }
    .miniBtn{
      display:inline-block;
      margin-top:10px;
      padding:10px 14px;
      border-radius:12px;
      background:rgba(0,255,213,.18);
      border:1px solid rgba(0,255,213,.30);
      color:#fff;
      font-weight:800;
      cursor:pointer;
    }
    .bg{
      max-width:760px;
      margin:18px auto 26px;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
    }
    .bg img{ width:100%; display:block; }
    footer{ opacity:.6; font-size:12px; padding:18px 10px 26px; text-align:center; }
    a{ color:#00ffd5; }
  </style>
</head>

<body>
  <div class="hero">
    <!-- Top image (your coin image) -->
    <img class="logo" src="IMG_6472.jpeg" alt="WALRUS" />
    <h1>$WALRUS</h1>
    <div class="sub">Presale â€¢ Built on Solana</div>

    <div class="card">
      <p class="big" id="stageText">Stage Loadingâ€¦</p>

      <div class="row">
        <div class="pill" id="priceText">Price Loadingâ€¦</div>
        <div class="pill" id="raisedText">Raised Loadingâ€¦</div>
        <div class="pill" id="nextText">Next Loadingâ€¦</div>
      </div>

      <div style="text-align:center;">
        <a class="btn" id="buyBtn" href="#">BUY WITH SOL</a>
      </div>

      <div class="note">
        <b>Presale Wallet</b>
        <div class="mono" id="walletText"></div>
        <button class="miniBtn" onclick="copyWallet()">ðŸ“‹ Copy Wallet</button>
        <span id="copyStatus" style="margin-left:10px;"></span>

        <div style="margin-top:14px;">
          <b>How to Buy</b><br/>
          1) Tap <b>BUY WITH SOL</b> (opens Phantom/Solflare)<br/>
          2) Send SOL to the presale wallet above<br/>
          3) Save your Solscan TX link (proof of payment)<br/>
          4) Tokens are airdropped after launch<br/>
          <small>Tip: Donâ€™t send from an exchange. Send from Phantom/Solflare.</small>
        </div>
      </div>
    </div>

    <div class="card">
      <div style="text-align:center; font-weight:900;">Your Estimated Tokens</div>
      <div class="note">
        Enter how much SOL you sent and we estimate your WALRUS allocation at the <b>current stage price</b>.
      </div>

      <input id="solInput" type="number" step="0.0001" placeholder="Enter SOL you sent (example: 1.5)" />
      <button class="miniBtn" onclick="calcTokens()">Calculate</button>
      <div class="mono" id="tokenResult">Enter SOL to calculateâ€¦</div>

      <div class="note">
        This is an estimate. Exact allocation is confirmed after presale close.
      </div>
    </div>

    <div class="card">
      <div style="text-align:center; font-weight:900;">Official Links</div>
      <div class="note" style="text-align:center;">
        X: <a href="https://x.com/walrusmemecoin" target="_blank">@walrusmemecoin</a><br/>
        Launch after Stage 20 ðŸš€
      </div>
    </div>

    <!-- Background image -->
    <div class="bg">
      <img src="IMG_6473.jpeg" alt="Background" />
    </div>

    <footer>Â© 2026 $WALRUS</footer>
  </div>

  <script>
    // =========================
    // EDIT THESE SETTINGS ONLY
    // =========================
    const DEPOSIT_WALLET = "9RHnZobeZBKSLDaTVEiKk5FewZapSTJfyHnR396d7QEi";
    const SOL_PER_STAGE = 100; // every 100 SOL raised = next stage
    const MAX_STAGE = 20;

    // Stage 1..20 prices (edit if you want)
    // These are USD per token (your marketing price ladder).
    const stagePrices = [
      0.00000010, // 1
      0.00000011, // 2
      0.00000012, // 3
      0.00000013, // 4
      0.00000014, // 5
      0.00000015, // 6
      0.00000017, // 7
      0.00000019, // 8
      0.00000022, // 9
      0.00000025, // 10
      0.00000029, // 11
      0.00000034, // 12
      0.00000040, // 13
      0.00000047, // 14
      0.00000055, // 15
      0.00000064, // 16
      0.00000074, // 17
      0.00000085, // 18
      0.00000097, // 19
      0.00000110  // 20
    ];

    // Token estimate:
    // Tokens â‰ˆ (SOL sent * SOL/USD) / (USD per token at current stage)
    let solUsdFallback = 150; // used if CoinGecko fails

    // Solana RPC (public). You can switch later to Helius/QuickNode.
    const RPC_URL = "https://api.mainnet-beta.solana.com";

    async function getSolBalance(pubkey) {
      const res = await fetch(RPC_URL, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
          jsonrpc: "2.0",
          id: 1,
          method: "getBalance",
          params: [pubkey]
        })
      });
      const data = await res.json();
      const lamports = data?.result?.value ?? 0;
      return lamports / 1e9;
    }

    function computeStage(totalSol) {
      const stage = Math.min(MAX_STAGE, Math.max(1, 1 + Math.floor(totalSol / SOL_PER_STAGE)));
      return stage;
    }

    async function getSolUsd() {
      try{
        const r = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd");
        const j = await r.json();
        const v = j?.solana?.usd;
        if (typeof v === "number" && v > 0) return v;
      }catch(e){}
      return solUsdFallback;
    }

    function fmt(n, decimals=2) {
      return Number(n).toFixed(decimals);
    }

    async function updatePresaleUI() {
      try {
        // wallet text + buy button
        document.getElementById("walletText").textContent = DEPOSIT_WALLET;
        document.getElementById("buyBtn").href = `solana:${DEPOSIT_WALLET}`;

        const totalSol = await getSolBalance(DEPOSIT_WALLET);
        const stage = computeStage(totalSol);
        const price = stagePrices[stage - 1];

        const nextTarget = Math.min(MAX_STAGE * SOL_PER_STAGE, stage * SOL_PER_STAGE);
        const nextStageAt = Math.min(MAX_STAGE * SOL_PER_STAGE, (stage) * SOL_PER_STAGE);

        document.getElementById("stageText").textContent =
          `Stage ${stage} Presale`;

        document.getElementById("priceText").textContent =
          `Stage ${stage} Price: $${price}`;

        document.getElementById("raisedText").textContent =
          `Raised: ${fmt(totalSol, 2)} SOL`;

        const nextText =
          (stage >= MAX_STAGE)
          ? `Final Stage Reached`
          : `Next Stage at: ${(stage * SOL_PER_STAGE).toFixed(0)} SOL`;

        document.getElementById("nextText").textContent = nextText;

      } catch (e) {
        console.error(e);
        document.getElementById("stageText").textContent = "Error loading stage (RPC issue)";
      }
    }

    async function calcTokens() {
      const solSent = parseFloat(document.getElementById("solInput").value || "0");
      if (!solSent || solSent <= 0) {
        document.getElementById("tokenResult").textContent = "Enter a valid SOL amount.";
        return;
      }

      // Use current stage price
      let totalSol = 0;
      try { totalSol = await getSolBalance(DEPOSIT_WALLET); } catch(e){}
      const stage = computeStage(totalSol);
      const priceUsdPerToken = stagePrices[stage - 1];

      const solUsd = await getSolUsd();
      const usdValue = solSent * solUsd;
      const estTokens = usdValue / priceUsdPerToken;

      document.getElementById("tokenResult").textContent =
        `At Stage ${stage}, ${fmt(solSent, 4)} SOL (~$${fmt(usdValue, 2)}) â‰ˆ ${Math.floor(estTokens).toLocaleString()} WALRUS`;
    }

    function copyWallet() {
      navigator.clipboard.writeText(DEPOSIT_WALLET);
      const s = document.getElementById("copyStatus");
      s.textContent = "âœ… Copied";
      setTimeout(()=>{ s.textContent=""; }, 1500);
    }

    // Run once + refresh every 30 seconds
    updatePresaleUI();
    setInterval(updatePresaleUI, 30000);
  </script>
</body>
</html>
